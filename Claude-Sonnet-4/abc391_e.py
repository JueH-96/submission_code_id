Wait, the BFS approach will be too slow for large inputs. Let me think of a more efficient approach.