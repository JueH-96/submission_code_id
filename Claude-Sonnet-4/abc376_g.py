Wait, I think my approach is getting too complex. Let me reconsider with a cleaner dynamic programming approach: