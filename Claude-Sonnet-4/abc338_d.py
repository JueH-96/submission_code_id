This is still not efficient enough. Let me think of the problem differently: